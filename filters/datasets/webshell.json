{
  "patterns": [
    {
      "level": "medium",
      "msg": "Potential PHP/ASP/JSP shell uploaded",
      "pattern": "/(<\\%3F(.*))|(<\\%(.*))|(<script(\\s+)language=\"?((php)|(asp)|(jsp))\"?>)/i"
    },
    {
      "level": "high",
      "msg": "Potential PHP command execution",
      "pattern": "/<\\%3F(.*)(system|eval|exec|pnctl|pthread|popen)/i"
    }
  ],
  "languages": [
    {
      "lang": "php",
      "pattern": "<(?P<tag>\\?|%)(php|=)?\\s+(?P<code>.*?)\\s+((?P=tag)>|$)"
    },
    {
      "lang": "php",
      "pattern": "<script\\s+language=\"?php\"?>(?P<code>.*?)<\\/script>"
    }
  ]
}
